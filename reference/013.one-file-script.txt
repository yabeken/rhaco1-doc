* テンプレートを内蔵した１ファイルスクリプト

一般的なテンプレートエンジンでは、スクリプトとテンプレートを分けます。
というか、そもそもそれが目的なんですけどね。

ところが、一画面しかないちょっとしたスクリプトでテンプレートエンジンを使おうと思うと大変ですよね。素の PHP で書いても良いのですが、メンテが面倒です。
そんな時、rhaco では、次のような感じで実装できます。

>||
<?php
include_once dirname(__FILE__).'/__init__.php';
Rhaco::import("generic.Flow");
$flow = new Flow();
$cnt = $flow->getVariable("cnt",1);
if($flow->isPost()){
	$cnt++;
}
$flow->setVariable("name",$flow->getVariable("name","ななし"));
$flow->setVariable("cnt",$cnt);
$flow->parser(__FILE__)->write();
Rhaco::end();
?>
<rt:template>
<html>
<head>
<title>1ファイルスクリプト</title>
</head>
<body>
{$name}さんこんにちは！{$cnt}回目だね！
<form method="post" rt:reference="true">
	名前：<input type="text" name="name"/>
	<input type="hidden" name="cnt"/>
	<input type="submit" value="送信"/>
</form>
</body>
</html>
</rt:template>
||<

はい、簡単ですね！
こんな感じで、ロジックとテンプレートを分離も１ファイルで実現できます。
ここでは、"<rt:template/>" タグが肝です。このタグがある場合には、その中身だけがテンプレートとして処理されます。
ちょっとした入力画面付きスクリプトを書くときなんかには重宝しますね。

* 参考
